<div style="display: flex; flex-direction: row; justify-content: stretch">

  <div style="height: 100%; width:210mm" *ngIf="report && report.mainGroup">
    <div #title (click)="SelectElement($event, title, report.title)">
      <input [(ngModel)]="report.title.Title" class="labelInput {{report.title.Class}}">

    </div>
    <ng-container
      *ngTemplateOutlet="group; context: getContex(report.mainGroup)"
    ></ng-container>
  </div>

  <div style="width: 300px; height: 100%;padding-left:30px">
    <button class="p-button" (click)="fai()">Open report</button>

    <h6>Element details</h6>
<div *ngIf="this.currentElement">
    <div
      *ngFor="let e of currentProperties"
      style="display: flex; flex-direction: row; padding: 10px;"
    >
      <div style="width: 50%">{{ e.name }}</div>
      <div *ngIf="e.readonly" style="width: 50%">{{ e.value }}</div>
      <div *ngIf="!e.readonly && e.type=='boolean'" style="width: 50%">
        <input type="checkbox" [(ngModel)]="this.currentElement[e.name]" />
      </div>
      <div *ngIf="!e.readonly && e.type=='number'" style="width: 50%">
        <input type="number" [(ngModel)]="this.currentElement[e.name]" />
      </div>
      <div *ngIf="!e.readonly && e.type=='string'" style="width: 50%">
        <input type="text" [(ngModel)]="this.currentElement[e.name]" />
      </div>

    </div>
 </div>
</div>

  <ng-template #group let-g>


    <div *ngIf="g.ElementType === 'Group'" style="width: 100%;">

      <div
        #maingroupHeader
        style="height: 120px; width: 100%; background-color: silver; padding:5px"
        (click)="SelectElement($event, maingroupHeader, g.GroupHeader)">
        <div style="display: flex; flex-direction: column; width:100%">
          <div style="display: flex; flex-direction: row;justify-content: stretch; align-items: center; width:100%"
               cdkDropList (cdkDropListDropped)="dropGroupBreak($event, g)">
            <div style="margin-right:10px">Group header</div>
            <div style="margin-right:10px">Break on change of</div>
            <div style="margin-right:10px" *ngFor="let f of g.BreakFields">

              <p-chip>
                {{f.baseField.name}}
                <fa-icon [icon]="['fas', 'times']" (click)="RemoveGroupBreak(g, f)" style="margin-left:8px"></fa-icon>
              </p-chip>
            </div>



          </div>

            <div cdkDropList (cdkDropListDropped)="dropGroup($event, g)"
              style="display: flex; flex-direction: row; justify-content:start; flex-wrap: wrap; align-items: center; width:100%; border: 3px dashed gray; height:80px" >
              <div #itm style="margin-right:10px;display: flex; flex-direction: row;" *ngFor="let f of g.Fields"  (click)="SelectElement($event, itm, f)">

                  <input [(ngModel)]="f.label" class="labelInput {{f.labelClass}}" [style.width.mm]="f.labelWidth" *ngIf="f.labelVisible">
                  <div [style.width.mm]="f.valueWidth" class=" {{f.valueClass}}">[{{f.baseField.name}}]</div>
                  <fa-icon [icon]="['fas', 'times']" (click)="RemoveGroup(g, f)" style="margin-left:8px"></fa-icon>

              </div>
            </div>

        </div>

      </div>
      <div style="padding-left: 50px">
        <ng-container
          *ngTemplateOutlet="group; context: getContex(g.child)"
        ></ng-container>
      </div>
      <div
        #maingroupFooter
        style="height: 30px; width: 100%; background-color: silver"
        (click)="SelectElement($event, maingroupFooter, g.GroupFooter)"
      >
        Group footer
      </div>
    </div>
    <div
      #details
      (cdkDropListDropped)="dropDetails($event, g)"
      *ngIf="g.ElementType === 'Detail'"
      (click)="SelectElement($event, details, g)"
    >
      Details
    </div>
  </ng-template>
</div>

